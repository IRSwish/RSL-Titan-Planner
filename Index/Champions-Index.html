<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Champions - RSL Tools</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #0e0e0e;
      color: #fcf6ff;
      margin: 0;
      padding: 0;
    }

    .container {
      width: 95%;
      max-width: 1400px;
      margin: 40px auto;
    }

    /* Search bar */
    .search-bar {
      text-align: center;
      margin-bottom: 15px;
    }

    #searchInput {
      width: 60%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      background: #1a1a1a;
      color: #fcf6ff;
      outline: none;
      box-shadow: 0 0 8px #f52584;
    }

    /* Faction bar */
    .faction-bar {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
      margin: 20px 0;
    }

    .faction-icon {
      width: 50px;
      height: 50px;
      border: 2px solid transparent;
      border-radius: 5px;
      cursor: pointer;
      transition: transform 0.2s, border-color 0.2s;
      object-fit: contain;
      background-color: #1a1a1a;
      padding: 4px;
    }

    .faction-icon:hover {
      transform: scale(1.1);
    }

    .faction-icon.active {
      border-color: #f52584;
      transform: scale(1.1);
    }

    /* Filters sections */
    .filters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 25px;
      align-items: center;
    }

    .section-label {
      width: 100%;
      text-align: center;
      margin: 10px 0 0 0;
      font-weight: 600;
      color: #bbbbbb;
    }

    .rarity-btn, .affinity-btn, .type-btn {
      background: none;
      border: 1px solid #555;
      color: #fcf6ff;
      border-radius: 8px;
      padding: 6px 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .rarity-btn.active, .affinity-btn.active, .type-btn.active {
      border-color: #f52584;
      background: #f52584;
    }

    .checkbox-container {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    /* Champion grid */
    .champion-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 15px;
      justify-items: center;
    }

    /* Champion card */
    .champion-card {
      width: 100%;
      max-width: 140px;
      text-align: center;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .champion-card:hover {
      transform: scale(1.05);
    }

    .card-image {
      position: relative;
      aspect-ratio: 140 / 182;
      width: 100%;
    }

    .champion-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 8px;
      display: block;
    }

    .rarity-frame {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: contain;
      pointer-events: none;
    }

    .affinity-icon {
      position: absolute;
      bottom: 10px;
      right: 10px;
      width: 26px;
      height: 26px;
      object-fit: contain;
      border-radius: 50%;
      pointer-events: none;
      z-index: 2;
    }

    .champion-name {
      font-size: 13px;
      font-weight: 600;
      margin-top: 6px;
      text-align: center;
    }

    .counter {
      text-align: center;
      margin-bottom: 15px;
      font-size: 15px;
      opacity: 0.8;
    }

    @media (max-width: 700px) {
      #searchInput { width: 90%; }
      .champion-card { max-width: 100px; }
      .faction-icon { width: 40px; height: 40px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search a champion...">
    </div>

    <div class="faction-bar" id="factionBar"></div>

    <!-- Filters: Rarity -->
    <div class="section-label">Rarity</div>
    <div class="filters" id="rarityFilters">
      <button class="rarity-btn" data-rarity="Mythic"><img src="img/rarity/Mythic_Icon.webp" alt="Mythic" width="24" height="24"></button>
      <button class="rarity-btn" data-rarity="Legendary"><img src="img/rarity/Legendary_Icon.webp" alt="Legendary" width="24" height="24"></button>
      <button class="rarity-btn" data-rarity="Epic"><img src="img/rarity/Epic_Icon.webp" alt="Epic" width="24" height="24"></button>
      <button class="rarity-btn" data-rarity="Rare"><img src="img/rarity/Rare_Icon.webp" alt="Rare" width="24" height="24"></button>
      <button class="rarity-btn" data-rarity="Uncommon"><img src="img/rarity/Uncommon_Icon.webp" alt="Uncommon" width="24" height="24"></button>
      <button class="rarity-btn" data-rarity="Common"><img src="img/rarity/Common_Icon.webp" alt="Common" width="24" height="24"></button>
    </div>

    <!-- Filters: Affinity -->
    <div class="section-label">Affinity</div>
    <div class="filters" id="affinityFilters">
      <button class="affinity-btn" data-affinity="Force"><img src="img/affinity/Force.webp" alt="Force" width="24" height="24"></button>
      <button class="affinity-btn" data-affinity="Magic"><img src="img/affinity/Magic.webp" alt="Magic" width="24" height="24"></button>
      <button class="affinity-btn" data-affinity="Spirit"><img src="img/affinity/Spirit.webp" alt="Spirit" width="24" height="24"></button>
      <button class="affinity-btn" data-affinity="Void"><img src="img/affinity/Void.webp" alt="Void" width="24" height="24"></button>
    </div>

    <!-- Filters: Type -->
    <div class="section-label">Type</div>
    <div class="filters" id="typeFilters">
      <button class="type-btn" data-type="HP">HP</button>
      <button class="type-btn" data-type="Attack">Attack</button>
      <button class="type-btn" data-type="Defense">Defense</button>
      <button class="type-btn" data-type="Support">Support</button>
    </div>

    <div class="checkbox-container" style="justify-content:center; margin-bottom: 15px;">
      <input type="checkbox" id="invocableOnly">
      <label for="invocableOnly">Invocable only</label>
    </div>

    <div class="counter" id="championCount"></div>

    <div id="championGrid" class="champion-grid"></div>
  </div>

  <script>
    let champions = [];
    let factions = [];

    const grid = document.getElementById('championGrid');
    const factionBar = document.getElementById('factionBar');
    const searchInput = document.getElementById('searchInput');
    const rarityButtons = document.querySelectorAll('.rarity-btn');
    const affinityButtons = document.querySelectorAll('.affinity-btn');
    const typeButtons = document.querySelectorAll('.type-btn');
    const invocableCheckbox = document.getElementById('invocableOnly');
    const countDisplay = document.getElementById('championCount');

    let selectedFaction = null;
    let selectedRarities = [];
    let selectedAffinities = [];
    let selectedTypes = [];

    fetch('champions.json')
      .then(res => res.json())
      .then(data => {
        champions = data.champions;
        factions = data.factions;
        renderFactions();
        displayChampions();
      })
      .catch(err => console.error("JSON load error:", err));

    function renderFactions() {
      factions.forEach(f => {
        const img = document.createElement('img');
        img.src = `img/factions/${f.icon}.webp`;
        img.alt = f.name;
        img.classList.add('faction-icon');
        img.dataset.faction = f.name;
        img.addEventListener('click', () => {
          document.querySelectorAll('.faction-icon').forEach(i => i.classList.remove('active'));
          if (selectedFaction === f.name) {
            selectedFaction = null;
          } else {
            selectedFaction = f.name;
            img.classList.add('active');
          }
          displayChampions();
        });
        factionBar.appendChild(img);
      });
    }

    function toggleSelection(array, value) {
      return array.includes(value) ? array.filter(v => v !== value) : [...array, value];
    }

    searchInput.addEventListener('input', displayChampions);
    invocableCheckbox.addEventListener('change', displayChampions);

    rarityButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        const rarity = btn.dataset.rarity;
        selectedRarities = toggleSelection(selectedRarities, rarity);
        displayChampions();
      });
    });

    affinityButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        const affinity = btn.dataset.affinity;
        selectedAffinities = toggleSelection(selectedAffinities, affinity);
        displayChampions();
      });
    });

    typeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        btn.classList.toggle('active');
        const type = btn.dataset.type;
        selectedTypes = toggleSelection(selectedTypes, type);
        displayChampions();
      });
    });

    function displayChampions() {
      const searchTerm = searchInput.value.toLowerCase();
      const invocableOnly = invocableCheckbox.checked;

      const filtered = champions.filter(c => {
        const matchesName = c.name.toLowerCase().includes(searchTerm);
        const matchesFaction = !selectedFaction || c.faction === selectedFaction;
        const matchesRarity = selectedRarities.length === 0 || selectedRarities.includes(c.rarity);
        const matchesAffinity = selectedAffinities.length === 0 || selectedAffinities.includes(c.affinity);
        const matchesType = selectedTypes.length === 0 || selectedTypes.includes(c.type);
        const matchesInvocable = !invocableOnly || c.invocable;
        return matchesName && matchesFaction && matchesRarity && matchesAffinity && matchesType && matchesInvocable;
      });

      grid.innerHTML = "";
      countDisplay.textContent = `${filtered.length} champion${filtered.length > 1 ? 's' : ''} found`;

      filtered.forEach(c => {
        const card = document.createElement('div');
        card.classList.add('champion-card');

        const imgWrapper = document.createElement('div');
        imgWrapper.classList.add('card-image');

        const img = document.createElement('img');
        img.src = `img/champions/${c.image}.webp`;
        img.alt = c.name;
        img.loading = "lazy";
        img.classList.add('champion-img');

        const frame = document.createElement('img');
        frame.src = `img/rarity/${c.rarity}_Icon.webp`;
        frame.alt = `${c.rarity} frame`;
        frame.classList.add('rarity-frame');

        const affinity = document.createElement('img');
        affinity.src = `img/affinity/${c.affinity}.webp`;
        affinity.alt = `${c.affinity} affinity`;
        affinity.classList.add('affinity-icon');

        const name = document.createElement('div');
        name.classList.add('champion-name');
        name.textContent = c.name;

        imgWrapper.appendChild(img);
        imgWrapper.appendChild(frame);
        imgWrapper.appendChild(affinity);
        card.appendChild(imgWrapper);
        card.appendChild(name);
        grid.appendChild(card);
      });

      if (filtered.length === 0) {
        grid.innerHTML = '<p style="grid-column: 1 / -1; text-align:center;">No champions found.</p>';
      }
    }
  </script>
</body>
</html>
