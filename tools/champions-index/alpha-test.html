<!DOCTYPE html>
<html lang="en">
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://unpkg.com/lucide@latest" defer></script>
  <meta charset="UTF-8">
  <script src="/config/site-config.js"></script>
  <script>document.title =  "Champions Index | " + window.siteConfig.title;</script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../../style/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8653563887265027" crossorigin="anonymous"></script>
  <style>

  /* === BASE === */
body { font-family:'Inter',sans-serif; color:#fcf6ff; margin:0; padding:0; }
.container { width:95%; max-width:1400px; margin:20px auto; }

/* === SEARCH === */
.search-bar { text-align:center; margin-bottom:15px; }
#searchInput { width:60%; padding:12px 16px; font-size:16px; border-radius:10px; border:2px solid #d4af37; background:#1a1a1a; color:#fcf6ff; outline:none; }
#searchInput:focus { border-color:#fce47e; }

/* === FACTIONS === */
.faction-bar { display:flex; justify-content:center; flex-wrap:wrap; gap:10px; margin:25px 0; }
.faction-icon { width:50px; height:50px; border:2px solid transparent; border-radius:5px; background:#1a1a1a; padding:4px; cursor:pointer; transition:.2s; object-fit:contain; }
.faction-icon:hover { transform:scale(1.1); border-color:#d4af37; }
.faction-icon.active { transform:scale(1.1); border-color:#d4af37; background:rgba(212,175,55,.15); box-shadow:0 0 6px rgba(212,175,55,.4);}

/* === FILTERS === */
.filters-wrapper { display:flex; justify-content:center; gap:40px; flex-wrap:wrap; margin-bottom:25px; }
.filter-section { text-align:center; width:250px; }
.section-label { font-weight:600; color:#bbb; margin-bottom:8px; }
.filter-buttons { display:grid; justify-items:center; gap:8px; }
.rarity-grid { grid-template-columns:repeat(3,1fr); }
.affinity-grid { grid-template-columns:repeat(2,1fr); }
.type-grid { grid-template-columns:repeat(2,1fr); }
.rarity-btn,.affinity-btn,.type-btn { background:#1a1a1a; border:2px solid #555; color:#fcf6ff; border-radius:8px; padding:4px 8px; cursor:pointer; width:60px; height:40px; display:flex; justify-content:center; align-items:center; }
.rarity-btn img,.affinity-btn img { width:24px; height:24px; object-fit:contain; }
.rarity-btn:hover,.affinity-btn:hover,.type-btn:hover { border-color:#d4af37; box-shadow:0 0 6px rgba(212,175,55,.4); }
.rarity-btn.active,.affinity-btn.active,.type-btn.active { border-color:#d4af37; background:rgba(212,175,55,.15); box-shadow:0 0 6px rgba(212,175,55,.4); }

/* === SWITCH === */
.checkbox-container { display:flex; align-items:center; justify-content:center; gap:8px; margin-bottom:15px; }
.switch { position:relative; display:inline-block; width:50px; height:26px; }
.switch input { opacity:0; width:0; height:0; }
.slider { position:absolute; inset:0; background:#444; border:2px solid #d4af37; border-radius:34px; cursor:pointer; }
.slider:before { content:""; position:absolute; height:18px; width:18px; left:3px; bottom:2px; background:#d4af37; border-radius:50%; box-shadow:0 0 6px rgba(212,175,55,.5); transition:.3s; }
.switch input:checked + .slider { background:#d4af37; }
.switch input:checked + .slider:before { transform:translateX(24px); background:#0e0e0e; }
.checkbox-container label { font-weight:600; font-size:14px; }

/* === GRID OF CHAMPIONS === */
.champion-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:15px; justify-items:center; }
.champion-card { width:100%; max-width:140px; text-align:center; cursor:pointer; }
.card-image { position:relative; width:100%; aspect-ratio:140/182; overflow:hidden; }
.card-image::before { content:""; position:absolute; inset:0; z-index:1; box-shadow:inset 0 0 22px rgba(0,0,0,.8); pointer-events:none; }
.card-image.mythical::before { box-shadow:inset 0 -2px 2px 12px rgba(0,0,0,.8); }
.card-image.legendary::before { box-shadow:inset 0 -2px 2px 11px rgba(0,0,0,.8); }
.card-image.epic::before { box-shadow:inset 0 -1px 2px 9px rgba(0,0,0,.8); }
.card-image.rare::before,.card-image.uncommon::before { box-shadow:inset 0 -1px 2px 8px rgba(0,0,0,.8); }
.card-image.common::before { box-shadow:inset 0 0 3px 6px rgba(0,0,0,.8); }
.champion-img { width:100%; height:100%; object-fit:cover; display:block; position:relative; z-index:0; }
.rarity-frame { position:absolute; inset:0; pointer-events:none; z-index:2; object-fit:contain; }
.affinity-icon { position:absolute; bottom:14px; left:12px; width:28px; height:28px; z-index:3; pointer-events:none; }
.champion-name { font-size:13px; font-weight:600; margin-top:6px; }
.counter { text-align:center; margin-bottom:15px; font-size:15px; opacity:.8; }

/* === SORT BAR === */
.sort-bar { display:flex; justify-content:center; gap:12px; margin-bottom:20px; }
.sort-btn { background:#1a1a1a; border:2px solid #555; color:#fcf6ff; padding:6px 10px; border-radius:8px; cursor:pointer; display:flex; align-items:center; gap:6px; font-size:14px; transition:.2s; }
.sort-btn:hover {border-color:#d4af37;box-shadow:0 0 6px rgba(212,175,55,.4);}
.sort-btn svg { width:18px; height:18px; }
.sort-btn.active { border-color:#d4af37; background:rgba(212,175,55,.15); }
.sort-btn .sort-icon { opacity:.8; }

/* === EFFECTS BAR === */

.effects-container {
  border: 2px solid #d4af37;
  border-radius: 12px;
  background: #0f0f0f;
  overflow: hidden;
  margin-top: 30px;
  margin-bottom:30px;
  padding: 0; /* üëà IMPORTANT : aucun padding */
}

.effects-container.collapsed {
  padding-bottom: 0;   /* üëà √©vite le vide sous le toggle */
  border-bottom-width: 2px;
}

.effects-toggle {
  padding: 14px 18px;
  background: #141414;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
  user-select: none;
}

.effects-toggle:hover {
  background: #1c1c1c;
}

.effects-toggle.open {
  background: #1c1c1c;
}

.effects-toggle i {
  transition: transform .25s ease;
}

.effects-toggle.open i {
  transform: rotate(180deg);
}

/* Panneau cachable */
/* Ferm√© ‚Üí z√©ro espace */
.effects-filters {
  max-height: 0;
  opacity: 0;
  overflow: hidden;
  padding: 0 !important;
  margin: 0 !important;
  transition: max-height .35s ease, opacity .25s ease, padding .25s ease;
}

/* D√©pli√© ‚Üí padding visible */
.effects-filters.open {
  max-height: 2000px;
  opacity: 1;
  padding: 20px 0 20px 0 !important;   /* üëà C‚ÄôEST ICI QUE TU G√àRES LE PADDING */
}


/* COLONNES DES 4 SECTIONS */
.effects-filters {
  margin-top: 25px;
  padding: 20px;
  display: grid;
  grid-template-columns: 380px 380px 240px 240px;
  gap: 40px;
  justify-content: center;
  width: 100%;
}

/* TITRES */
.effect-title {
  font-family: 'American Captain', sans-serif;
  font-size: 22px;
  margin-bottom: 12px;
  text-align: center;
  letter-spacing: 1px;
  background: linear-gradient(to bottom, #feeec1, #e09f40);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}

/* BUFFS + DEBUFFS = COLONNES LARGES */
.effect-grid {
  display: grid;
  grid-template-columns: repeat(6, 48px);  /* ‚¨ÖÔ∏è ic√¥nes plus espac√©es */
  gap: 12px;
  justify-content: center;
}

/* IC√îNES BUFF/DEBUFF */
.effect-icon {
  width: 48px;
  height: 48px;
  border-radius: 6px;
  border: 2px solid #444;
  background: #1a1a1a;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  transition: border-color .25s, box-shadow .25s, transform .15s;
}

.effect-icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.effect-icon:hover {
  transform: scale(1.12);
  border-color: #d4af37;
}

.effect-icon.active {
  transform: scale(1.08);
  border-color: #d4af37;
  box-shadow: 0 0 10px rgba(212,175,55,0.6);
}

/* POSITIVE / NEGATIVE EFFECTS = COLONNES NARROW */
.effect-checklist {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.effect-checklist label {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 15px;
}

.effect-checklist input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: #d4af37;
}

.effect-icon img {
  filter: grayscale(92%) contrast(1.6);
  opacity: 0.75;
  transition: filter .5s ease, opacity .5s ease, transform .5s ease;
}

.effect-icon.active img {
  filter: none;
  opacity: 1;
}

.reset-wrapper { display:flex; justify-content:center; margin-bottom:20px; }
.reset-btn{ background:#1a1a1a; border:2px solid #555; color:#fff; padding:6px 14px; border-radius:8px; cursor:pointer;font-size:14px; transition:.2s;}
.reset-btn:hover{border:2px solid #d4af37;}

/* === MODAL === */
.modal-overlay { position:fixed; inset:0; background:rgba(0,0,0,.6); backdrop-filter:blur(4px); display:none; justify-content:center; align-items:center; z-index:99999; }
.modal-overlay.active { display:flex; }
.modal-content { background:#1a1a1a; border:2px solid #d4af37; border-radius:12px; padding:20px; padding-left:8px; width:900px; display:flex; flex-direction:column; gap:16px; max-height:88vh; overflow:hidden; position:relative; box-shadow:0 0 25px rgba(212,175,55,.4); }
.modal-top-row { display:flex; gap:20px; align-items:stretch; }
.modal-close { position:absolute; right:10px; top:10px; background:none; border:none; color:#fcf6ff; cursor:pointer; z-index:5}
.modal-close svg { width:26px; height:26px; }
.modal-left,.modal-right { flex:1; display:flex; justify-content:center; }
.modal-right { align-items:center; }
.modal-col { display:flex; flex-direction:column; align-items:center; width:33%; gap:15px; }
.modal-divider { width:2px; background:rgba(212,175,55,.4); border-radius:2px; }

.modal-scroll { overflow-y:auto; overflow-x:hidden; display:flex; flex-direction:column;scrollbar-width:thin; scrollbar-color:#d4af37 #0e0e0e;direction: rtl; padding-left:12px;position: relative; z-index: 1;}
.modal-scroll > * { direction: ltr;}
.modal-top-row { display:flex; gap:20px; align-items:stretch; flex-shrink:0; }

/* Scrollbar styl√©e du modal */
.modal-scroll::-webkit-scrollbar { width:10px; }
.modal-scroll::-webkit-scrollbar-track { background:#0e0e0e; border-right:1px solid rgba(212,175,55,0.2); }
.modal-scroll::-webkit-scrollbar-thumb { background:linear-gradient(180deg,#d4af37 0%,#f52584 100%); border-radius:10px; border:2px solid #0e0e0e; box-shadow:0 0 8px rgba(212,175,55,0.3); }
.modal-scroll::-webkit-scrollbar-thumb:hover { background:linear-gradient(180deg,#f52584 0%,#00c9ff 100%); box-shadow:0 0 12px rgba(0,201,255,0.4); }

/* Firefox support */
.modal-content { scrollbar-width:thin; scrollbar-color:#d4af37 #0e0e0e; }

/* === MODAL IMAGES === */
.modal-img-wrapper { position:relative; width:140px; height:182px;margin-top: auto;margin-bottom: auto;}
.modal-champion-img { width:100%; height:100%; object-fit:cover; }
.modal-frame-img { position:absolute; inset:0; width:100%; pointer-events:none; }
.modal-faction-banner { height:240px; object-fit:contain; }
.modal-affinity-big { position:absolute; bottom:15px; left:12px; width:32px; height:32px; z-index:3; pointer-events:none; }
.modal-faction-banner {margin-top: auto;margin-bottom: auto;}
.faction-col, .champion-col {gap:0;}

/* === MODAL TITLES === */
.modal-name,.modal-col-title { font-family:'American Captain',sans-serif; font-size:32px; text-align:center; background:linear-gradient(to bottom,#feeec1,#e09f40); -webkit-background-clip:text; -webkit-text-fill-color:transparent; }

/* === STATS === */
.stats-col { justify-content:center; padding: 0 50px 0px 50px; }
.modal-stats { display:flex; flex-direction:column; gap:10px; width:100%; }
.stat-row { display:flex; align-items:center; justify-content:space-between; width:100%; }
.stat-left { display:flex; align-items:center; gap:8px; }
.stat-left span { font-size:16px; }
.stat-row svg { width:22px; height:22px; }

/* === MYTHICAL FORM === */
.form-slider {display: flex;align-items: center;gap: 8px;margin-bottom: 12px;}
.slider-label {font-size: 14px;color: #d4af37;font-weight: 600;}
.slider-track {position: relative;width: 70px;height: 28px;background: #0e0e0e;border: 2px solid #d4af37;border-radius: 20px;cursor: pointer;}
.slider-thumb {position: absolute;top: 2px;left: 2px;width: 23px;height: 23px;background: #d4af37;border-radius: 50%;transition: left .25s ease;}
.slider-thumb.alt {left: calc(100% - 25px);}


/* STAT VALUES (COMPARISON MODE INCLUDED) */
.stat-value { display:flex; justify-content:flex-end; gap:10px;}
.stat-number { min-width:40px; text-align:right; font-size:16px; font-weight:600; }
.stat-number.positive { color:#00c86b; }
.stat-number.negative { color:#f52525; }
.stat-percent { min-width:45px; text-align:center; font-size:14px; }
.stat-percent.positive { color:#00c86b; }
.stat-percent.negative { color:#f52525; }
.stat-percent.equal { color:#fff; }
.stat-number.primary   { width:50px; text-align:right; }
.stat-percent          { width:50px; text-align:center; }
.stat-number.secondary { width:50px; text-align:left; }

/* === COMPARE MODE === */
.compare-header { font-size:13px; margin-bottom:6px; opacity:.85; }
.compare-header span { font-weight:600; }
.compare-input-wrapper { width:100%; }
.compare-input { width: 92.5%; padding:6px 8px; border-radius:6px; border:1px solid #555; background:#0e0e0e; color:#fcf6ff; outline:none; }
.compare-input:focus { border-color:#d4af37; }
.compare-suggestions { margin-top:4px; background:#111; max-height:140px; overflow-y:auto; }
.compare-suggestion { padding:4px 8px; font-size:13px; cursor:pointer; }
.compare-suggestion:hover { background:#222; }
.compare-toggle { position:absolute; background:none; border:none; color:#fcf6ff; cursor:pointer; display:flex; align-items:center; justify-content:center; }
.compare-toggle svg { width:28px; height:28px; }
.compare-bottom { display:flex; justify-content:center; }
.compare-toggle { position:static; background:none; border:none; padding:8px 12px; color:#fcf6ff; cursor:pointer; }

/* === SKILLS === */

.skills-block{width:100%;display:flex;flex-direction:column;gap:10px;padding-right:4px;margin-top:20px;}
.skills-block:empty{margin-top:0;}

.skill-entry{position:relative;display:flex;gap:50px;align-items:flex-start;padding:12px 50px;background:#111;border:1px solid #333;border-radius:8px;align-items:center;}
.skill-info{display:flex;flex-direction:column;gap:4px;}
.skill-title{font-family:'American Captain',sans-serif;font-size:24px;background:linear-gradient(to bottom,#feeec1,#e09f40);-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.skill-desc{font-size:14px;line-height:1.35;opacity:.9;}
.skill-bracket{color:#00c821;font-weight:600;}
.multiplier-label{color:#d4af37;font-weight:700;}

/* ==== IC√îNES PREMIUM ==== */
.skill-icon-wrapper{position:relative;width:96px;height:96px;flex:0 0 auto;display:flex;align-items:center;justify-content:center;border-radius:50%;overflow:hidden;}
.skill-icon{position:relative;z-index:1;width:90px;height:90px;object-fit:cover;border-radius:50%;}
.skill-icon-wrapper::before{content:"";position:absolute;inset:0px;border-radius:50%;background:radial-gradient(circle,rgba(0,0,0,0)60%,rgba(0,0,0,1)67%);z-index:2;}
.skill-icon-wrapper::after{content:"";position:absolute;inset:0;border-radius:50%;background:linear-gradient(to bottom,#e6ce52,#9c731e);z-index:3;-webkit-mask:radial-gradient(circle,transparent 65%,#000 66%);mask:radial-gradient(circle,transparent 65%,#000 66%);}

.skill-icon-wrapper.passive{position:relative;}

/* stroke blanc annulaire */
.skill-icon-wrapper.passive .passive-stroke{position:absolute;inset:1px;border-radius:100%;z-index:5;background:conic-gradient(transparent 0deg 0deg,#fff 240deg 360deg);-webkit-mask:radial-gradient(circle,transparent 68%,#000 68%);mask:radial-gradient(circle,transparent 68%,#000 68%);animation:spin 1s linear infinite;pointer-events:none;}

/* glow externe bleu */
.skill-icon-wrapper.passive .passive-glow{position:absolute;inset:-1px;border-radius:100%;z-index:4;background:conic-gradient(transparent 0deg 0deg, rgb(0 139 255) 120deg 360deg);-webkit-mask:radial-gradient(circle,transparent 53%,#000 78%);mask: radial-gradient(circle, transparent 53%, #000 78%);filter:blur(5px);animation:spin 1s linear infinite;pointer-events:none;}
@keyframes spin{from{transform:rotate(0deg);}to{transform:rotate(360deg);}}

/* Aura */
.aura-entry { display:flex; gap:50px; align-items:center; padding:12px 50px; background:#141414; border:1px solid #444; border-radius:8px; margin-bottom:40px; }
.aura-icon { width:96px; height:96px; object-fit:contain; flex-shrink:0;position:relative;}
.aura-text { display:flex; flex-direction:column; gap:2px; }
.aura-title { font-family:'American Captain',sans-serif; font-size:24px; color:#d4af37; }
.aura-desc { font-size:14px; opacity:.85; }
.aura-icon-wrapper{position:relative;width:96px;height:96px;flex-shrink:0;}
.aura-icon-wrapper .aura-icon{width:100%;height:100%;object-fit:contain;}
.aura-icon-wrapper::after{content:"";position:absolute;inset:0;background:url("img/aura/BORDER.webp") center/contain no-repeat;z-index:10;pointer-events:none;}


/* === MEDIA QUERIES === */
@media(max-width:900px){ .filter-buttons{grid-template-columns:repeat(2,1fr);} .filters-wrapper{flex-direction:column; align-items:center;} }
@media(max-width:700px){ #searchInput{width:90%;} .champion-card{max-width:100px;} .faction-icon{width:40px; height:40px;} }

  </style>
</head>

<body>

<div id="menu-container"></div>

<div class="header-wrapper">
  <header id="page-title">CHAMPIONS INDEX</header>
</div> 

<div class="container">
  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Search a champion...">
  </div>

  <div class="faction-bar" id="factionBar"></div>

  <!-- FILTER SECTIONS -->
  <div class="filters-wrapper">
    <!-- Rarity -->
    <div class="filter-section">
      <div class="section-label">Rarity</div>
      <div class="filter-buttons rarity-grid">
        <button class="rarity-btn" data-rarity="Mythical"><img src="img/rarity/Mythical_Icon.webp"></button>
        <button class="rarity-btn" data-rarity="Legendary"><img src="img/rarity/Legendary_Icon.webp"></button>
        <button class="rarity-btn" data-rarity="Epic"><img src="img/rarity/Epic_Icon.webp"></button>
        <button class="rarity-btn" data-rarity="Rare"><img src="img/rarity/Rare_Icon.webp"></button>
        <button class="rarity-btn" data-rarity="Uncommon"><img src="img/rarity/Uncommon_Icon.webp"></button>
        <button class="rarity-btn" data-rarity="Common"><img src="img/rarity/Common_Icon.webp"></button>
      </div>
    </div>

    <!-- Affinity -->
    <div class="filter-section">
      <div class="section-label">Affinity</div>
      <div class="filter-buttons affinity-grid">
        <button class="affinity-btn" data-affinity="Force"><img src="img/affinity/Force.webp"></button>
        <button class="affinity-btn" data-affinity="Magic"><img src="img/affinity/Magic.webp"></button>
        <button class="affinity-btn" data-affinity="Spirit"><img src="img/affinity/Spirit.webp"></button>
        <button class="affinity-btn" data-affinity="Void"><img src="img/affinity/Void.webp"></button>
      </div>
    </div>

    <!-- Type -->
    <div class="filter-section">
      <div class="section-label">Type</div>
      <div class="filter-buttons type-grid">
        <button class="type-btn" data-type="HP">HP</button>
        <button class="type-btn" data-type="Attack">Attack</button>
        <button class="type-btn" data-type="Defense">Defense</button>
        <button class="type-btn" data-type="Support">Support</button>
      </div>
    </div>
  </div>
<div class="effects-container">
  <div id="effectsToggle" class="effects-toggle">
    <span>Effects</span>
    <i data-lucide="chevron-down"></i>
  </div>

  <!-- === FILTERS : EFFECTS === -->
<div class="effects-filters">

    <!-- Buffs -->
    <div class="effect-section">
      <div class="effect-title">BUFFS</div>
      <div id="buffFilterGrid" class="effect-grid"></div>
    </div>

    <!-- Debuffs -->
    <div class="effect-section">
      <div class="effect-title">DEBUFFS</div>
      <div id="debuffFilterGrid" class="effect-grid"></div>
    </div>

    <!-- Positive Effects -->
    <div class="effect-section">
      <div class="effect-title">POSITIVE EFFECTS</div>
      <div id="positiveFilterList" class="effect-checklist"></div>
    </div>

    <!-- Negative Effects -->
    <div class="effect-section">
      <div class="effect-title">NEGATIVE EFFECTS</div>
      <div id="negativeFilterList" class="effect-checklist"></div>
    </div>

  </div>
</div>

  <div class="sort-bar">
    <button class="sort-btn" data-stat="hp">
      <i data-lucide="heart"></i>
      <i class="sort-icon" data-lucide="arrow-down-wide-narrow"></i>
    </button>

    <button class="sort-btn" data-stat="atk">
      <i data-lucide="swords"></i>
      <i class="sort-icon" data-lucide="arrow-down-wide-narrow"></i>
    </button>

    <button class="sort-btn" data-stat="def">
      <i data-lucide="shield"></i>
      <i class="sort-icon" data-lucide="arrow-down-wide-narrow"></i>
    </button>

    <button class="sort-btn" data-stat="spd">
      <i data-lucide="chevrons-up"></i>
      <i class="sort-icon" data-lucide="arrow-down-wide-narrow"></i>
    </button>
  </div>

  <div class="checkbox-container">
    <label for="invocableOnly">Hide Non-Summonable Champions</label>
    <label class="switch">
      <input type="checkbox" id="invocableOnly">
      <span class="slider"></span>
    </label>
  </div>

  <div class="reset-wrapper">
    <button id="resetFilters" class="reset-btn">‚ü≥ Reset Filters</button>
  </div>

  <div class="counter" id="championCount"></div>
  <div id="championGrid" class="champion-grid"></div>
</div>

<!-- === MODAL CHAMPION === -->
<div id="championModal" class="modal-overlay">
    <div class="modal-content">

    <button class="modal-close">
      <i data-lucide="x"></i>
    </button>

    <div class="modal-scroll">

    <!-- Partie haute : FACTION | CHAMPION | STATS -->
    <div class="modal-top-row">

      <div class="modal-col faction-col">
        <div id="modalFactionTitle" class="modal-col-title"></div>
        <img id="modalFactionBanner" class="modal-faction-banner" src="">
      </div>

      <div class="modal-divider"></div>

      <div class="modal-col champion-col">
        <div id="modalChampionTitle" class="modal-col-title"></div>

        <div class="modal-img-wrapper">
          <img id="modalChampionImg" class="modal-champion-img" src="">
          <img id="modalFrameImg" class="modal-frame-img" src="">
          <img id="modalAffinityBig" class="modal-affinity-big" src="">
        </div>
      </div>

      <div class="modal-divider"></div>

      <div class="modal-col stats-col">
        <div id="modalStatsTitle" class="modal-col-title"></div>

        <div id="formSwitch" class="form-slider" style="display:none;">
          <span class="slider-label">Base</span>
          <div class="slider-track">
            <div class="slider-thumb"></div>
          </div>
          <span class="slider-label">Alt</span>
        </div>


        <div class="compare-header" id="compareHeader" style="display:none;">
          Comparing with <span id="compareTargetName"></span>
        </div>

        <div class="compare-input-wrapper" id="compareInputWrapper" style="display:none;">
          <input type="text" id="compareInput" class="compare-input" placeholder="Type a champion name..." autocomplete="off">
          <div class="compare-suggestions" id="compareSuggestions"></div>
        </div>

        <div class="modal-stats">
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="heart"></i><span>HP</span></div>
            <div class="stat-value" id="statHP"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="swords"></i><span>ATK</span></div>
            <div class="stat-value" id="statATK"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="shield"></i><span>DEF</span></div>
            <div class="stat-value" id="statDEF"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="chevrons-up"></i><span>SPD</span></div>
            <div class="stat-value" id="statSPD"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="circle-divide"></i><span>C.RATE</span></div>
            <div class="stat-value" id="statCRATE"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="circle-percent"></i><span>C.DMG</span></div>
            <div class="stat-value" id="statCDMG"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="shield-plus"></i><span>RES</span></div>
            <div class="stat-value" id="statRES"></div>
          </div>
          <div class="stat-row">
            <div class="stat-left"><i data-lucide="locate-fixed"></i><span>ACC</span></div>
            <div class="stat-value" id="statACC"></div>
          </div>
          <div class="compare-bottom">
            <button class="compare-toggle" id="compareToggle">
              <i data-lucide="arrow-right-left"></i>
            </button>
          </div>
        </div>

      </div>

    </div><!-- /.modal-top-row -->

    <!-- S√©parateur horizontal -->
    <div class="modal-horizontal-separator"></div>

    <!-- Partie basse : SKILLS & AURA -->
    <div id="modalSkills" class="skills-block"></div>

    </div>

  </div>

  </div>
</div>

  </div>
</div>



<script>

let champions = [];
let factions = [];
let championForms = {};
let currentForms = null;
let currentFormIndex = 0;

// Effets s√©lectionn√©s par l‚Äôutilisateur
let activeEffects = {
  Buff: [],
  Debuff: [],
  Positive: [],
  Negative: []
};

// Effets (buffs / debuffs / effets positifs / n√©gatifs)
const EFFECTS = {
  Buff: [],
  Debuff: [],
  Positive: [],
  Negative: []
};

const grid = document.getElementById('championGrid');
const factionBar = document.getElementById('factionBar');
const searchInput = document.getElementById('searchInput');
const rarityButtons = document.querySelectorAll('.rarity-btn');
const affinityButtons = document.querySelectorAll('.affinity-btn');
const typeButtons = document.querySelectorAll('.type-btn');
const invocableCheckbox = document.getElementById('invocableOnly');
const countDisplay = document.getElementById('championCount');

let selectedFaction = null;
let selectedRarities = [];
let selectedAffinities = [];
let selectedTypes = [];
let currentSort = { stat: null, order: "asc" }; 

document.addEventListener("DOMContentLoaded", () => {

  initSqlJs({
    locateFile: file => `https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/${file}`
  }).then(SQL => {
    
    fetch("champions.db") // üî• Ajuste le chemin selon ton site !
      .then(res => res.arrayBuffer())
      .then(buffer => {
        const db = new SQL.Database(new Uint8Array(buffer));
        
        const result = db.exec("SELECT * FROM champions;");
        
        if (!result.length) {
          console.error("La table champions semble vide ou introuvable");
          return;
        }

          champions = result[0].values.map(r => ({
          id: r[0],
          name: r[1],
          faction: r[2],
          rarity: r[3],
          affinity: r[4],
          type: r[5],
          image: r[6],
          invocable: r[7] === 1,

          hp: Number(r[8]) || 0,
          atk: Number(r[9]) || 0,
          def: Number(r[10]) || 0,
          spd: Number(r[11]) || 0,
          crate: Number(r[12]) || 0,
          cdmg: Number(r[13]) || 0,
          res: Number(r[14]) || 0,
          acc: Number(r[15]) || 0,

          aurastat: r[16] || null,
          aura: r[17] || null,

          s1: r[18] || null,
          s2: r[19] || null,
          s3: r[20] || null,
          s4: r[21] || null,
          s5: r[22] || null,
          s6: r[23] || null,
          p1: r[24] || null,
          p2: r[25] || null,
          IGid: r[27] || null,
          effects: (r[26] || "").split("\n").map(e => e.trim()).filter(e => e.length > 0)
        }));

        // === Charger la table effects ===
        const effectsResult = db.exec("SELECT * FROM effects;");
        if (effectsResult.length) {
          const rows = effectsResult[0].values;
          rows.forEach(r => {
            const [id, name, type, description] = r;
            if (!EFFECTS[type]) EFFECTS[type] = [];
            EFFECTS[type].push({ id, name, type, description });
          });
        } else {
          console.warn("Table 'effects' introuvable ou vide");
        }

        // === Regrouper les formes mythiques par nom ===
        champions.forEach(c => {
          if (!championForms[c.name]) championForms[c.name] = [];
          championForms[c.name].push(c);
        });

        // === G√©n√©rer les filtres Buffs ===
        const buffGrid = document.getElementById("buffFilterGrid");
        EFFECTS.Buff.forEach(e => {
          const div = document.createElement("div");
          div.className = "effect-icon";
          div.dataset.id = e.id;
          div.dataset.type = "Buff";
          div.title = e.name;
          div.innerHTML = `<img src="img/buffs/${e.id}.webp" alt="${e.name}">`;
          buffGrid.appendChild(div);
        });

        // === G√©n√©rer les filtres Debuffs ===
        const debuffGrid = document.getElementById("debuffFilterGrid");
        EFFECTS.Debuff.forEach(e => {
          const div = document.createElement("div");
          div.className = "effect-icon";
          div.dataset.id = e.id;
          div.dataset.type = "Debuff";
          div.title = e.name;
          div.innerHTML = `<img src="img/debuffs/${e.id}.webp" alt="${e.name}">`;
          debuffGrid.appendChild(div);
        });

        // === G√©n√©rer les filtres Positive Effects ===
        const posList = document.getElementById("positiveFilterList");
        EFFECTS.Positive.forEach(e => {
          const row = document.createElement("label");
          row.innerHTML = `
            <input type="checkbox" data-type="Positive" data-id="${e.name}">
            <span>${e.name}</span>
          `;
          posList.appendChild(row);
        });

        // === G√©n√©rer les filtres Negative Effects ===
        const negList = document.getElementById("negativeFilterList");
        EFFECTS.Negative.forEach(e => {
          const row = document.createElement("label");
          row.innerHTML = `
            <input type="checkbox" data-type="Negative" data-id="${e.name}">
            <span>${e.name}</span>
          `;
          negList.appendChild(row);
        });

        // === Listeners BUFF / DEBUFF (ic√¥nes cliquables) ===
        document.querySelectorAll(".effect-icon").forEach(icon => {
          icon.addEventListener("click", () => {
            icon.classList.toggle("active");

            const type = icon.dataset.type; // Buff / Debuff
            const id   = icon.dataset.id;   // ID (ex: "increase_atk")

            if (icon.classList.contains("active")) {
              activeEffects[type].push(id);
            } else {
              activeEffects[type] = activeEffects[type].filter(x => x !== id);
            }

            displayChampions();
          });
        });

        // === Listeners POSITIVE / NEGATIVE (checkboxes) ===
        document.querySelectorAll(".effect-checklist input").forEach(input => {
          input.addEventListener("change", () => {
            const type = input.dataset.type; // Positive / Negative
            const id   = input.dataset.id;   // Label exact (ex: "Unkillable")

            if (input.checked) {
              activeEffects[type].push(id);
            } else {
              activeEffects[type] = activeEffects[type].filter(x => x !== id);
            }

            displayChampions();
          });
        });

        // === Collapse Effects ===
        const effectsContainer = document.querySelector(".effects-container");
        const effectsToggle = document.getElementById("effectsToggle");
        const effectsPanel  = document.querySelector(".effects-filters");

        effectsToggle.addEventListener("click", () => {
          const isOpen = effectsPanel.classList.contains("open");

          if (isOpen) {
            effectsPanel.classList.remove("open");
            effectsToggle.classList.remove("open");
            effectsContainer.classList.add("collapsed");
          } else {
            effectsPanel.classList.add("open");
            effectsToggle.classList.add("open");
            effectsContainer.classList.remove("collapsed");
          }

          lucide.createIcons();
        });

        factions = [...new Set(champions.map(c => c.faction))].sort();

        renderFactions();
        displayChampions();
      })
      .catch(err => console.error("Erreur chargement champions.db :", err));

  });

});

function renderFactions() {
  factions.forEach(f => {
    const img = document.createElement('img');
    const icon = f.toLowerCase().replace(/ /g, "");
    img.src = `img/factions/${icon}.webp`;
    img.alt = f;
    img.classList.add('faction-icon');
    img.dataset.faction = f;

    img.addEventListener('click', () => {
      document.querySelectorAll('.faction-icon').forEach(i => i.classList.remove('active'));
      if (selectedFaction === f) selectedFaction = null;
      else {
        selectedFaction = f;
        img.classList.add('active');
      }
      displayChampions();
    });

    factionBar.appendChild(img);
  });
}

function toggleSelection(array, value) {
  return array.includes(value) ? array.filter(v => v !== value) : [...array, value];
}

searchInput.addEventListener('input', displayChampions);
invocableCheckbox.addEventListener('change', displayChampions);

rarityButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    btn.classList.toggle('active');
    selectedRarities = toggleSelection(selectedRarities, btn.dataset.rarity);
    displayChampions();
  });
});

affinityButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    btn.classList.toggle('active');
    selectedAffinities = toggleSelection(selectedAffinities, btn.dataset.affinity);
    displayChampions();
  });
});

typeButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    btn.classList.toggle('active');
    selectedTypes = toggleSelection(selectedTypes, btn.dataset.type);
    displayChampions();
  });
});

document.getElementById("resetFilters").addEventListener("click", resetAllFilters);

document.querySelectorAll(".sort-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const stat = btn.dataset.stat;

    // ---- Gestion des 3 clics ----
    if (currentSort.stat !== stat) {
      // 1er clic ‚Üí DESC
      currentSort.stat = stat;
      currentSort.order = "desc";
    } else if (currentSort.order === "desc") {
      // 2e clic ‚Üí ASC
      currentSort.order = "asc";
    } else {
      // 3e clic ‚Üí Reset complet
      currentSort.stat = null;
      currentSort.order = "asc";

      // RESET VISUEL COMPLET
      document.querySelectorAll(".sort-btn").forEach(b => {
        b.classList.remove("active");

        // remet l‚Äôic√¥ne en "down" par d√©faut
        const icon = b.querySelector(".sort-icon");
        icon.setAttribute("data-lucide", "arrow-down-wide-narrow");
      });

      lucide.createIcons();
      displayChampions();
      return;
    }

    // ---- Mise √† jour visuelle ----
    document.querySelectorAll(".sort-btn").forEach(b => b.classList.remove("active"));
    btn.classList.add("active");

    // ic√¥ne up/down selon ordre
    const icon = btn.querySelector(".sort-icon");
    icon.setAttribute("data-lucide",
      currentSort.order === "desc"
        ? "arrow-down-wide-narrow"
        : "arrow-up-wide-narrow"
    );

    lucide.createIcons();
    displayChampions();
  });
});

const sliderTrack = document.querySelector(".slider-track");
const sliderThumb = document.querySelector(".slider-thumb");

sliderTrack.addEventListener("click", () => {
  const newIndex = currentFormIndex === 0 ? 1 : 0;

  // slider animation
  if (newIndex === 1) {
    sliderThumb.classList.add("alt");
  } else {
    sliderThumb.classList.remove("alt");
  }

  // charger la forme
  loadForm(newIndex);
});


function displayChampions() {
  const searchTerm = searchInput.value.toLowerCase();
  const invocableOnly = invocableCheckbox.checked;

  const filtered = champions.filter(c => {
    const matchesName = c.name.toLowerCase().includes(searchTerm);
    const matchesFaction = !selectedFaction || c.faction === selectedFaction;
    const matchesRarity = selectedRarities.length === 0 || selectedRarities.includes(c.rarity);
    const matchesAffinity = selectedAffinities.length === 0 || selectedAffinities.includes(c.affinity);
    const matchesType = selectedTypes.length === 0 || selectedTypes.includes(c.type);
    const matchesInvocable = !invocableOnly || c.invocable;
    return matchesName && matchesFaction && matchesRarity && matchesAffinity && matchesType && matchesInvocable;
  });

  // === FILTER BY EFFECTS ===
  const hasActiveEffects =
    activeEffects.Buff.length ||
    activeEffects.Debuff.length ||
    activeEffects.Positive.length ||
    activeEffects.Negative.length;

  let finalFiltered = filtered;

  if (hasActiveEffects) {
    finalFiltered = filtered.filter(c => {
      if (!c.effects || c.effects.length === 0) return false;

      // buffs = ids ‚Üí doivent √™tre pr√©sents dans c.effects
      for (const eff of activeEffects.Buff) {
        if (!c.effects.includes(eff)) return false;
      }

      // debuffs
      for (const eff of activeEffects.Debuff) {
        if (!c.effects.includes(eff)) return false;
      }

      // positive
      for (const eff of activeEffects.Positive) {
        if (!c.effects.includes(eff)) return false;
      }

      // negative
      for (const eff of activeEffects.Negative) {
        if (!c.effects.includes(eff)) return false;
      }

      return true;
    });
  } else {
    finalFiltered = filtered;
  }

  grid.innerHTML = "";

  // === TRI ===
  if (currentSort.stat) {
    finalFiltered.sort((a, b) => {
      const valA = Number(a[currentSort.stat]) || 0;
      const valB = Number(b[currentSort.stat]) || 0;

      return currentSort.order === "asc"
        ? valA - valB
        : valB - valA;
    });
  }

  // === Eliminations des doublons mythiques ===
  const unique = [];
  const seen = new Set();

  finalFiltered.forEach(c => {
    if (!seen.has(c.name)) {
      unique.push(c);
      seen.add(c.name);
    }
  });

  // === COMPTEUR CORRECT ===
  countDisplay.textContent =
  `${unique.length} champion${unique.length !== 1 ? 's' : ''} found`;

  unique.forEach(c => {
    const card = document.createElement('div');
    card.classList.add('champion-card');

    const imgWrapper = document.createElement('div');
    imgWrapper.classList.add('card-image', c.rarity.toLowerCase());

    const img = document.createElement('img');
    img.src = `img/champions/${c.image}.webp`;
    img.alt = c.name;
    img.loading = "lazy";
    img.classList.add('champion-img');

    const frame = document.createElement('img');
    frame.src = `img/rarity/${c.rarity}.webp`;
    frame.alt = `${c.rarity} frame`;
    frame.classList.add('rarity-frame');

    const affinity = document.createElement('img');
    affinity.src = `img/affinity/${c.affinity}.webp`;
    affinity.alt = `${c.affinity} affinity`;
    affinity.classList.add('affinity-icon');

    const name = document.createElement('div');
    name.classList.add('champion-name');
    name.textContent = c.name;

    imgWrapper.appendChild(img);
    imgWrapper.appendChild(frame);
    imgWrapper.appendChild(affinity);
    card.appendChild(imgWrapper);
    card.appendChild(name);

    if (currentSort.stat) {
      const statValue = document.createElement("div");
      statValue.style.fontSize = "12px";
      statValue.style.opacity = "0.8";
      statValue.style.marginTop = "2px";
      statValue.textContent = c[currentSort.stat];
      card.appendChild(statValue);
    }

    card.addEventListener("click", () => openChampionModal(c));
    grid.appendChild(card);
  });

  if (finalFiltered.length === 0) {
    grid.innerHTML = '<p style="grid-column: 1 / -1; text-align:center;">No champions found.</p>';
  }
}

function resetAllFilters() {
  // Recherche
  searchInput.value = "";

  // Faction
  selectedFaction = null;
  document.querySelectorAll(".faction-icon").forEach(el => el.classList.remove("active"));

  // Rarete / Affinit√© / Type
  selectedRarities = [];
  selectedAffinities = [];
  selectedTypes = [];

  document.querySelectorAll(".rarity-btn").forEach(el => el.classList.remove("active"));
  document.querySelectorAll(".affinity-btn").forEach(el => el.classList.remove("active"));
  document.querySelectorAll(".type-btn").forEach(el => el.classList.remove("active"));

  // Invocable only
  invocableCheckbox.checked = false;

  // Reset tri
  currentSort.stat = null;
  currentSort.order = "asc";
  document.querySelectorAll(".sort-btn").forEach(btn => {
    btn.classList.remove("active");
    const icon = btn.querySelector(".sort-icon");
    icon.setAttribute("data-lucide", "arrow-down-wide-narrow");
  });

  lucide.createIcons();
  displayChampions();
}


const modal = document.getElementById("championModal");

let primaryChampion = null;
let compareChampion = null;

const compareToggle = document.getElementById("compareToggle");
const compareHeader = document.getElementById("compareHeader");
const compareTargetName = document.getElementById("compareTargetName");
const compareInputWrapper = document.getElementById("compareInputWrapper");
const compareInput = document.getElementById("compareInput");
const compareSuggestions = document.getElementById("compareSuggestions");

const STAT_CONFIG = [
  { key: "hp",   id: "statHP",   isPercent: false },
  { key: "atk",  id: "statATK",  isPercent: false },
  { key: "def",  id: "statDEF",  isPercent: false },
  { key: "spd",  id: "statSPD",  isPercent: false },
  { key: "crate",id: "statCRATE",isPercent: true  },
  { key: "cdmg", id: "statCDMG", isPercent: true  },
  { key: "res",  id: "statRES",  isPercent: false },
  { key: "acc",  id: "statACC",  isPercent: false }
];

function formatValue(val, isPercent) {
  if (isNaN(val)) return "‚Äî";
  return isPercent ? `${val}%` : val;
}

function formatPercent(p) {
  if (!isFinite(p)) return "0%";
  const rounded = Math.round(p);
  const sign = rounded > 0 ? "+" : "";
  return `${sign}${rounded}%`;
}

function updateStatsDisplay(primary, secondary = null) {
  STAT_CONFIG.forEach(cfg => {
    const el = document.getElementById(cfg.id);
    if (!el) return;

    const p = primary[cfg.key] ?? 0;
    const s = secondary ? secondary[cfg.key] ?? 0 : null;

    // MODE NORMAL (pas de comparatif)
    if (!secondary) {
      el.textContent = formatValue(p, cfg.isPercent);
      return;
    }

    // MODE COMPARATIF
    const equal = p === s;
    const pct = s ? ((p - s) / s) * 100 : 0;

    // couleurs
    const leftClass  = equal ? "positive" : (p > s ? "positive" : "negative");
    const rightClass = equal ? "positive" : (p > s ? "negative" : "positive");
    const pctClass   = equal ? "equal" : (pct >= 0 ? "positive" : "negative");

    el.innerHTML = `
      <span class="stat-number primary ${leftClass}">${formatValue(p, cfg.isPercent)}</span>
      <span class="stat-percent ${pctClass}">${formatPercent(pct)}</span>
      <span class="stat-number secondary ${rightClass}">${formatValue(s, cfg.isPercent)}</span>
    `;
  });
}

function renderSkills(champ) {
  const container = document.getElementById("modalSkills");
  if (!container) return;
  container.innerHTML = "";

  const gid = champ.IGid || champ.image || champ.id;

  // ===== AURA =====
  if (champ.aurastat && champ.aura) {
    const auraHTML = `
      <div class="aura-entry">
        <div class="aura-icon-wrapper">
          <img class="aura-icon" src="img/aura/${champ.aurastat}.webp" alt="Aura">
        </div>
        <div class="aura-text">
          <div class="aura-title">AURA</div>
          <div class="aura-desc">${champ.aura}</div>
        </div>
      </div>
    `;
    container.insertAdjacentHTML("beforeend", auraHTML);
  }

  // ===== SKILLS ACTIFS s1..s6 =====
  let activeCount = 0;
  for (let i = 1; i <= 6; i++) {
    const raw = champ[`s${i}`];
    if (!raw) continue;

    const [title, ...descLines] = raw.split("\n");
    const desc = descLines.join("\n");

    const img = `img/skills/${gid}_s${i}.webp`;
    activeCount++;
    const formattedDesc = (desc || "")
      .replace(/\[(.*?)\]/g, '<span class="skill-bracket">[$1]</span>')
      .replace(/^.*?Multiplier:/gm, '<span class="multiplier-label">$&</span>')
      .replace(/\n/g, "<br>");

    const skillHTML = `
      <div class="skill-entry">
        <div class="skill-icon-wrapper">
            <img class="skill-icon" src="${img}">
        </div>
        <div class="skill-info">
          <div class="skill-title">${title}</div>
          <div class="skill-desc">
            ${formattedDesc}
          </div>
        </div>
      </div>
    `;
    container.insertAdjacentHTML("beforeend", skillHTML);
  }

  // ===== PASSIFS p1, p2 =====
  for (let p = 1; p <= 2; p++) {
    const raw = champ[`p${p}`];
    if (!raw) continue;

    const [title, ...descLines] = raw.split("\n");
    const desc = descLines.join("\n");

    const imgIndex = activeCount + p; // ex: 3 skills actifs -> p1 = _s4.webp
    const img = `img/skills/${gid}_s${imgIndex}.webp`;
    const formattedDesc = (desc || "")
      .replace(/\[(.*?)\]/g, '<span class="skill-bracket">[$1]</span>')
      .replace(/^.*?Multiplier:/gm, '<span class="multiplier-label">$&</span>')
      .replace(/\n/g, "<br>");
      
    const passiveHTML = `
      <div class="skill-entry">
        <div class="skill-icon-wrapper passive">
          <div class="passive-stroke"></div>
          <div class="passive-glow"></div>
            <img class="skill-icon" src="${img}">
        </div>
        <div class="skill-info">
          <div class="skill-title">${title}</div>
          <div class="skill-desc">
            ${formattedDesc}
          </div>
        </div>
      </div>
    `;
    container.insertAdjacentHTML("beforeend", passiveHTML);
  }
}

function resetCompareUI() {
  compareChampion = null;
  compareHeader.style.display = "none";
  compareTargetName.textContent = "";
  compareInputWrapper.style.display = "none";
  compareSuggestions.innerHTML = "";
  compareToggle.dataset.mode = "off";
  compareToggle.innerHTML = `<i data-lucide="arrow-right-left"></i>`;
  lucide.createIcons();
}

function loadForm(index) {
  currentFormIndex = index;
  const champ = currentForms[index];

  primaryChampion = champ;
  resetCompareUI();

  // images
  document.getElementById("modalChampionImg").src = `img/champions/${champ.image}.webp`;
  document.getElementById("modalFrameImg").src = `img/rarity/${champ.rarity}.webp`;
  document.getElementById("modalFactionBanner").src = `img/factions/${champ.faction.toLowerCase().replace(/ /g,"")}.webp`;
  document.getElementById("modalAffinityBig").src = `img/affinity/${champ.affinity}.webp`;

  // titres
  document.getElementById("modalFactionTitle").textContent = champ.faction;
  document.getElementById("modalChampionTitle").textContent = champ.name;
  document.getElementById("modalStatsTitle").textContent = champ.type;

  // stats
  updateStatsDisplay(champ, null);

  // skills
  renderSkills(champ);

  // ic√¥nes
  lucide.createIcons();

  // maj du switch
  document.querySelectorAll(".form-option").forEach(opt => opt.classList.remove("active"));
  const activeBtn = document.querySelector(`.form-option[data-form="${index}"]`);
  if (activeBtn) activeBtn.classList.add("active");
}

function openChampionModal(champ) {

  // r√©cup√©rer toutes les formes de ce champion
  currentForms = championForms[champ.name] || [champ];
  currentFormIndex = 0;

  // afficher ou masquer le switch
  const fs = document.getElementById("formSwitch");
  fs.style.display = currentForms.length > 1 ? "flex" : "none";

  document.querySelector(".slider-thumb").classList.remove("alt");

  // charger la forme 0 (Base)
  loadForm(0);

    modal.classList.add("active");
  }

compareToggle.addEventListener("click", () => {
  const mode = compareToggle.dataset.mode || "off";

  // OFF -> passage en s√©lection (affiche input)
  if (mode === "off") {
    compareToggle.dataset.mode = "select";
    compareToggle.innerHTML = `<i data-lucide="x"></i>`;
    compareInputWrapper.style.display = "block";
    compareHeader.style.display = "none";
    compareInput.value = "";
    compareSuggestions.innerHTML = "";
    compareInput.focus();
    updateStatsDisplay(primaryChampion, null);
    lucide.createIcons();
    return;
  }

  // SELECT ou ON -> reset (fermer le comparatif)
  resetCompareUI();
  updateStatsDisplay(primaryChampion, null);
});

function selectCompareChampion(champ) {
  compareChampion = champ;
  compareToggle.dataset.mode = "on";

  compareHeader.style.display = "block";
  compareTargetName.textContent = champ.name;

  compareInputWrapper.style.display = "none";
  compareSuggestions.innerHTML = "";

  updateStatsDisplay(primaryChampion, compareChampion);
}

compareInput.addEventListener("input", () => {
  const query = compareInput.value.toLowerCase();
  compareSuggestions.innerHTML = "";
  if (!query) return;

  const matches = champions
    .filter(c =>
      primaryChampion &&
      c.id !== primaryChampion.id &&
      c.name.toLowerCase().includes(query)
    )
    .slice(0, 8);

  matches.forEach(c => {
    const item = document.createElement("div");
    item.className = "compare-suggestion";
    item.textContent = c.name;
    item.addEventListener("click", () => selectCompareChampion(c));
    compareSuggestions.appendChild(item);
  });
});

compareInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter") {
    const query = compareInput.value.toLowerCase();
    let match = champions.find(c =>
      primaryChampion &&
      c.id !== primaryChampion.id &&
      c.name.toLowerCase() === query
    );

    if (!match && compareSuggestions.firstElementChild) {
      const name = compareSuggestions.firstElementChild.textContent;
      match = champions.find(c => c.name === name);
    }

    if (match) {
      selectCompareChampion(match);
    }
  }
});


document.querySelector(".modal-close").addEventListener("click", () => {
  modal.classList.remove("active");
});

modal.addEventListener("click", e => {
  if (e.target === modal) modal.classList.remove("active");
});
</script>

  <div class="adsense-container">
    <div class="ad-label">Advertisement</div>

    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8653563887265027"
     data-ad-slot="9042028911"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>

    <script>
      (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
  </div>

<script src="../../script.js"></script>
</body>
</html>
